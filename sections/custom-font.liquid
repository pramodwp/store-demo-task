{% if section.settings.enable %}
  <style data-custom-fonts>
    {% assign items = section.blocks | reverse %}

    {% for block in items %}
      {% assign name = block.settings.name %}
      {% assign url = block.settings.custom_font_url %}
      {% assign custom_font_weight = block.settings.custom_font_weight %}
      {% assign customFontStyle = block.settings.custom_font_style %}
      {% assign font_usage = block.settings.font_usage %}

      {% if url != blank and url != "" %}
        {% capture _font_type %}
          {% if url contains ".otf" %}
            opentype
          {% elsif url contains ".ttf" %}
            truetype
          {% elsif url contains ".svg" %}
            svg
          {% elsif url contains ".woff2" %}
            woff2
          {% else %}
            woff
          {% endif %}
        {% endcapture %}
        
        {% assign font_type = _font_type | strip %}
        
        @font-face {
          font-family: '{{ name }}';
          src: url({{ url }}) format('{{ font_type }}');
          {% if customFontStyle != 'none' %}
            font-style: {{ customFontStyle }};
          {% endif %}
          {% if custom_font_weight != 'none' %}
            font-weight: {{ custom_font_weight }};
          {% endif %}
        }

        {% if font_usage == "heading" %}
          h1, h2, h3, h4, h5, h6 {
            font-family: '{{ name }}' !important;
            font-weight: {{ custom_font_weight }} !important;
          }
        {% elsif font_usage == "body" %}
          body {
            font-family: '{{ name }}' !important;
            font-weight: {{ custom_font_weight }} !important;
          }
        {% endif %}
        
      {% endif %}
    {% endfor %}
  </style>
{% endif %}

{% schema %}
{
  "name": "Custom Fonts",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable",
      "label": "Enable",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "font",
      "name": "Font Set",
      "settings": [
        {
          "type": "text",
          "id": "name",
          "label": "Font name",
          "default": "customfont"
        },
        {
          "type": "select",
          "id": "custom_font_weight",
          "label": "Font weight",
          "default": "none",
          "options": [
            {
              "value": "none",
              "label": "None"
            },
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "bold",
              "label": "Bold"
            }
          ]
        },
        {
          "type": "text",
          "id": "custom_font_url",
          "label": "Font URL"
        },
        {
          "type": "select",
          "id": "font_usage",
          "label": "Apply to",
          "default": "heading",
          "options": [
            {
              "value": "heading",
              "label": "Headings (h1 to h6)"
            },
            {
              "value": "body",
              "label": "Body"
            }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Default",
      "category": "Custom Fonts",
      "blocks": [
        {
          "type": "font",
          "settings": {
            "name": "Heading Font",
            "custom_font_weight": "bold",
            "font_usage": "heading"
          }
        },
        {
          "type": "font",
          "settings": {
            "name": "Body Font",
            "custom_font_weight": "normal",
            "font_usage": "body"
          }
        }
      ]
    }
  ]
}
{% endschema %}
